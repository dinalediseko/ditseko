<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Service</title>
    <!-- html-docx-js library for DOCX export -->
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
        }
        body {
            background: linear-gradient(145deg, #e0e7ef 0%, #d2dbe8 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px;
        }
        .card {
            max-width: 1000px;
            width: 100%;
            background: rgba(255,255,255,0.75);
            backdrop-filter: blur(4px);
            border-radius: 48px;
            box-shadow: 0 25px 50px -12px rgba(0, 30, 60, 0.4);
            padding: 30px;
            border: 1px solid rgba(255,245,210,0.7);
        }
        h1 {
            font-weight: 600;
            font-size: 2.2rem;
            background: linear-gradient(135deg, #8B1E1E, #2C4A3B);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-top: 0;
            margin-bottom: 0.2rem;
            padding-left: 20px;
        }
        .sub {
            color: #1e3b4f;
            margin-bottom: 2rem;
            margin-top: 0.2rem;
            font-weight: 400;
            padding-left: 28px;
            font-size: 1.1rem;
        }
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
            background: rgba(255,255,255,0.7);
            padding: 25px 20px;
            border-radius: 40px;
            backdrop-filter: blur(2px);
            border: 1px solid #fff2d4;
        }
        .input-group {
            flex: 1 1 200px;
            min-width: 180px;
        }
        .input-group label {
            display: block;
            font-weight: 700;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: #2C3E50;
            margin-bottom: 6px;
        }
        .input-group input {
            width: 100%;
            padding: 12px 18px;
            font-size: 1rem;
            border: 2px solid #f0d9b5;
            border-radius: 60px;
            transition: 0.2s;
            background: white;
            color: #1e2b3a;
        }
        .input-group input:focus {
            border-color: #b22222;
            outline: none;
            box-shadow: 0 0 0 4px rgba(178, 34, 34, 0.2);
        }
        .preview-title {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: 25px 0 15px;
        }
        .preview-title h2 {
            margin: 0;
            font-weight: 500;
            color: #1e3b4f;
            font-size: 1.8rem;
        }
        .badge {
            background: #b22222;
            color: #fdeacb;
            padding: 6px 20px;
            border-radius: 60px;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 2px 10px #b2222260;
        }
        .certificate-frame {
            background: #fbf4e3;
            border-radius: 48px;
            padding: 25px;
            box-shadow: inset 0 0 0 2px #ffeac2, 0 20px 35px -12px #00000030;
            margin-bottom: 30px;
            display: flex;
            justify-content: center;
        }
        #certificatePreview {
            max-width: 700px;
            width: 100%;
            transition: all 0.1s ease;
        }
        .action-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 15px;
        }
        .btn-download {
            background: linear-gradient(145deg, #1e3b4f, #0f2a3a);
            border: none;
            color: white;
            font-size: 1.3rem;
            font-weight: 500;
            padding: 16px 40px;
            border-radius: 60px;
            display: inline-flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: 0.2s;
            border: 1px solid #b99e6b;
            box-shadow: 0 10px 20px -8px #04131f;
        }
        .btn-download:hover {
            background: linear-gradient(145deg, #14313f, #091e2b);
            transform: scale(1.02);
        }
        .btn-download:active {
            transform: scale(0.98);
        }
        .footnote {
            font-size: 0.8rem;
            color: #435e74;
            text-align: right;
            margin-top: 15px;
            border-top: 1px dashed #c9b386;
            padding-top: 15px;
        }
    </style>
</head>
<body>
    <div class="card">
        <h1>CUSTOMER SERVICE ¬∑ HONOURS</h1>
        <div class="sub"></div>

        <!-- INPUT FIELDS -->
        <div class="form-row">
            <div class="input-group">
                <label>First name</label>
                <input type="text" id="inputName" placeholder="e.g. Didintle" value="Isabella">
            </div>
            <div class="input-group">
                <label>Surname</label>
                <input type="text" id="inputSurname" placeholder="e.g. Diseko" value="Rossi">
            </div>
            <div class="input-group">
                <label>Identity number</label>
                <input type="text" id="inputId" placeholder="e.g. 010615XXXXXXX" value="CS-9420">
            </div>
        </div>

        <!-- PREVIEW
        <div class="preview-title">
            <h2>üéØ live preview</h2>
            <span class="badge">‚Äúexcellent performance‚Äù</span>
        </div>
        <div class="certificate-frame">
            <div id="certificatePreview">
                <!-- injected dynamically -->
            </div>
        </div>
  -->

        <!-- DOWNLOAD BUTTON -->
        <div class="action-buttons">
            <button class="btn-download" id="downloadBtn"> DOCX</button>
        </div>
        <div class="footnote">
            for DITSEKO
        </div>
    </div>

    <script>
        (function() {
            // ---------- DOM elements ----------
            const nameInput = document.getElementById('inputName');
            const surnameInput = document.getElementById('inputSurname');
            const idInput = document.getElementById('inputId');
            const previewDiv = document.getElementById('certificatePreview');
            const downloadBtn = document.getElementById('downloadBtn');

            // ---------- helper: escape html ----------
            function escapeHtml(unsafe) {
                return unsafe.replace(/[&<>"']/g, function(m) {
                    if(m === '&') return '&amp;';
                    if(m === '<') return '&lt;';
                    if(m === '>') return '&gt;';
                    if(m === '"') return '&quot;';
                    if(m === "'") return '&#039;';
                    return m;
                });
            }

            // ---------- format current date (e.g. 20 February 2026) ----------
            function getFormattedDate() {
                const now = new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                return now.toLocaleDateString(undefined, options);
            }

            // ---------- generate certificate with colourful pattern, logo, phrase & college date ----------
            function generateCertificateDiv(nameVal, surnameVal, idVal) {
                // escape inputs
                const safeName = escapeHtml(nameVal.trim());
                const safeSurname = escapeHtml(surnameVal.trim());
                const safeId = escapeHtml(idVal.trim());

                // build full name or placeholder
                const fullName = (safeName || safeSurname) ? `${safeName} ${safeSurname}`.trim() : '____________________';
                const idDisplay = safeId || '____________________';
                const currentDate = getFormattedDate();

                // college foundation year / date line
                const collegeDate = 'est. 1987 ¬∑ issued ' + currentDate;

                // ----- colourful patterned border using diagonal stripes (red & gold) -----
                return `
                    <div style="background: repeating-linear-gradient(135deg, #b22222, #b22222 16px, #f7d97e 16px, #f7d97e 32px); padding: 20px; border-radius: 48px; box-shadow: 0 15px 30px -10px #3b2a1c;">
                        <!-- inner white card with smooth corners -->
                        <div style="background: white; border-radius: 36px; padding: 30px 25px; box-shadow: 0 8px 18px rgba(90, 40, 20, 0.2); border: 2px solid #faeacb;">

                            <!-- LOGO PLACEHOLDER + COLLEGE NAME (colourful) -->
                            <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 10px; flex-wrap: wrap;">
                                <div style="width: 70px; height: 70px; background: linear-gradient(145deg, #1e4b5e, #092b3a); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #ffdfa7; font-size: 38px; border: 3px solid #b99e6b; box-shadow: 0 4px 8px #00000030;">üéì</div>
                                <div style="font-size: 28px; font-weight: 700; background: linear-gradient(135deg, #8B1E1E, #2C4A3B); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: 1px;">CUSTOMER SERVICE COLLEGE</div>
                            </div>

                            <!-- EXCELLENT PERFORMANCE PHRASE (prominent) -->
                            <div style="text-align: center; margin: 10px 0 20px; padding: 8px 0; border-top: 2px solid #f0cf91; border-bottom: 2px solid #f0cf91;">
                                <span style="font-size: 22px; font-weight: 500; color: #b45f2b; font-style: italic; background: #fffae6; padding: 6px 30px; border-radius: 60px;">‚≠ê for their excellent performance in customer service ‚≠ê</span>
                            </div>

                            <!-- MAIN TITLE & NAME (classic) -->
                            <h1 style="font-size: 40px; margin: 5px 0 0; color: #2C4A3B; font-weight: 500; text-transform: uppercase; letter-spacing: 3px;">customer service</h1>
                            <p style="font-size: 18px; color: #886e42; margin: 0 0 25px; font-style: italic;">professional course ¬∑ with honours</p>

                            <div style="font-size: 22px; margin: 25px 0 10px; color: #1f3b2c;">this certificate is awarded to</div>
                            <div style="font-size: 48px; font-weight: 700; color: #b22222; margin: 0 0 15px; line-height: 1.2; border-bottom: 3px double #d4a76a; padding-bottom: 10px; display: inline-block; width: auto;">${fullName}</div>

                            <!-- IDENTITY NUMBER (stylish) -->
                            <div style="margin: 20px 0 25px; font-size: 20px;">
                                <span style="background: #e9dbc4; padding: 8px 24px; border-radius: 60px; color: #2d3e36; font-weight: 500;">üÜî ${idDisplay}</span>
                            </div>

                            <!-- COLLEGE DATE & SIGNATURE LINE (colourful) -->
                            <div style="margin-top: 35px; border-top: 2px dashed #c5a56b; padding-top: 25px; display: flex; justify-content: space-between; align-items: flex-end; flex-wrap: wrap; gap: 20px;">
                                <div style="text-align: left;">
                                    <div style="font-weight: 600; color: #1e4b5e; font-size: 16px;">üìÖ college date</div>
                                    <div style="font-size: 18px; font-weight: 500; color: #2d1f0c;">${collegeDate}</div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-weight: 600; color: #1e4b5e; font-size: 16px;">üìú director</div>
                                    <div style="font-size: 22px; font-family: 'Brush Script MT', cursive; color: #8B1E1E;">E. Mitchell</div>
                                </div>
                            </div>

                            <!-- small pattern echo at bottom -->
                            <div style="margin-top: 20px; font-size: 13px; color: #b99e6b; display: flex; justify-content: center; gap: 8px; border-top: 1px solid #f0cf91; padding-top: 15px;">
                                <span style="background: #fdf3df; padding: 4px 16px; border-radius: 40px;">‚ú¶ excellence ‚ú¶ integrity ‚ú¶ service ‚ú¶</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            // ---------- live preview update ----------
            function updatePreview() {
                const name = nameInput.value;
                const surname = surnameInput.value;
                const id = idInput.value;
                const certificateHTML = generateCertificateDiv(name, surname, id);
                previewDiv.innerHTML = certificateHTML;
            }

            // input listeners
            [nameInput, surnameInput, idInput].forEach(input => {
                input.addEventListener('input', updatePreview);
            });

            // initial render
            updatePreview();

            // ---------- DOCX download (pattern & styles preserved) ----------
            downloadBtn.addEventListener('click', function() {
                const name = nameInput.value;
                const surname = surnameInput.value;
                const id = idInput.value;

                const divContent = generateCertificateDiv(name, surname, id);

                // full HTML document with minimal extra styling
                const fullDoc = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Customer Service Certificate</title>
    <style>body { margin: 0; background: #f2ede2; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }</style>
</head>
<body>
    ${divContent}
</body>
</html>`;

                try {
                    if (typeof htmlDocx === 'undefined') {
                        alert('DOCX library not ready ‚Äî please refresh');
                        return;
                    }
                    const convertedBlob = htmlDocx.asBlob(fullDoc);
                    const url = window.URL.createObjectURL(convertedBlob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `Certificate_${name || 'participant'}_CustomerService.docx`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    window.URL.revokeObjectURL(url);
                } catch (error) {
                    alert('DOCX generation error: ' + error.message);
                }
            });
        })();
    </script>
</body>
  </html>
